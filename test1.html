<meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="en">  
<head>  
  <meta charset="UTF-8">  
  <title>IQ Tester App</title>  
  <style>  
    body {  
      font-family: Arial, sans-serif;  
      background: linear-gradient(135deg, #000000, #001f3f);  
      color: white;  
      display: flex;  
      justify-content: center;  
      align-items: center;  
      height: 100vh;  
      margin: 0;  
    }  
    #app {  
      width: 700px;  
      background: #0a0a0a;  
      border-radius: 15px;  
      padding: 20px;  
      box-shadow: 0 0 25px #00d0ff;  
      text-align: center;  
      overflow-y: auto;  
      max-height: 95vh;  
    }  
    h1, h2, h3 {  
      color: #00d0ff;  
      text-shadow: 0 0 10px #00d0ff;  
    }  
    .question {  
      font-size: 20px;  
      margin-bottom: 15px;  
      min-height: 60px;  
    }  
    .answers {  
      display: flex;  
      flex-direction: column;  
      align-items: center;  
    }  
    button {  
      background: black;  
      color: white;  
      border: 2px solid #00d0ff;  
      border-radius: 10px;  
      padding: 10px 20px;  
      margin: 8px;  
      cursor: pointer;  
      transition: 0.3s;  
      font-size: 16px;  
    }  
    button:hover {  
      background: #001f3f;  
      box-shadow: 0 0 15px #00d0ff;  
      transform: scale(1.05);  
    }  
    #controls {  
      margin-top: 15px;  
    }  
    #timer {  
      font-size: 18px;  
      margin-bottom: 10px;  
      color: #ffcc00;  
      text-shadow: 0 0 10px #ffcc00;  
    }  
    #scoreboard {  
      margin-top: 20px;  
      text-align: left;  
    }  
    .hidden {  
      display: none;  
    }  
    .review {  
      margin-top: 15px;  
      padding: 10px;  
      border: 1px solid #00d0ff;  
      border-radius: 10px;  
      text-align: left;  
    }  
    .correct {  
      color: #00ff00;  
    }  
    .wrong {  
      color: #ff4444;  
    }  
  </style>  
</head>  
<body>  
<div id="app">  
  <h1>IQ Tester</h1>  
  <div id="timer">Time left: 05:00</div>  
  <div id="quiz">  
    <div class="question" id="question"></div>  
    <div class="answers" id="answers"></div>  
    <div id="controls">  
      <button id="prevBtn">Previous</button>  
      <button id="nextBtn">Next</button>  
    </div>  
  </div>  
  <div id="result" class="hidden">  
    <h2>Test Completed</h2>  
    <p id="finalScore"></p>  
    <p id="suggestion"></p>  
    <div id="scoreboard"></div>  
    <h3>Review Answers</h3>  
    <div id="reviewAnswers"></div>  
    <button onclick="restart()">Restart</button>  
  </div>  
</div>  

<script>  
  let questions = [];  
  let currentQuestionIndex = 0;  
  let score = 0;  
  let timer;  
  let timeLeft = 300; // 5 minutes  
  let userAnswers = [];  
  let lockedQuestions = new Set(); // ðŸ”’ Added lock feature  

  // Fetch questions from Open Trivia API  
  async function loadQuestions() {  
    let res = await fetch("https://opentdb.com/api.php?amount=10&type=multiple");  
    let data = await res.json();  

    questions = data.results.map((q) => {  
      let options = [...q.incorrect_answers];  
      options.push(q.correct_answer);  
      options.sort(() => Math.random() - 0.5);  

      return {  
        question: q.question,  
        answers: options.map(opt => ({  
          text: opt,  
          correct: opt === q.correct_answer  
        }))  
      };  
    });  

    startQuiz();  
  }  

  function startQuiz(){  
    currentQuestionIndex = 0;  
    score = 0;  
    timeLeft = 300;  
    userAnswers = Array(questions.length).fill(null);  
    lockedQuestions.clear(); // ðŸ”’ Reset locks  
    document.getElementById("result").classList.add("hidden");  
    document.getElementById("quiz").classList.remove("hidden");  
    showQuestion();  
    startTimer();  
  }  

  function showQuestion(){  
    const questionObj = questions[currentQuestionIndex];  
    document.getElementById("question").innerHTML = decodeHTML(questionObj.question);  
    const answersDiv = document.getElementById("answers");  
    answersDiv.innerHTML = "";  

    questionObj.answers.forEach((ans, idx) => {  
      const btn = document.createElement("button");  
      btn.textContent = decodeHTML(ans.text);  
      btn.onclick = () => {  
        if (!lockedQuestions.has(currentQuestionIndex)) { // ðŸ”’ Prevent change if locked  
          selectAnswer(idx);  
        }  
      };  

      if(userAnswers[currentQuestionIndex] === idx) {  
        btn.style.background = "#001f3f";  
        btn.style.boxShadow = "0 0 15px #00d0ff";  
      }  

      // ðŸ”’ Grey out locked questions  
      if (lockedQuestions.has(currentQuestionIndex)) {  
        btn.disabled = true;  
        btn.style.opacity = "0.6";  
        btn.style.cursor = "not-allowed";  
      }  

      answersDiv.appendChild(btn);  
    });  

    document.getElementById("prevBtn").disabled = currentQuestionIndex === 0;  
    document.getElementById("nextBtn").textContent = currentQuestionIndex === questions.length-1 ? "Submit" : "Next";  
  }  

  function selectAnswer(idx){  
    userAnswers[currentQuestionIndex] = idx;  
    showQuestion();  
  }  

  document.getElementById("nextBtn").onclick = () => {  
    if(userAnswers[currentQuestionIndex] !== null){  
      lockedQuestions.add(currentQuestionIndex); // ðŸ”’ Lock after Next  
    }  

    if(currentQuestionIndex < questions.length-1){  
      currentQuestionIndex++;  
      showQuestion();  
    } else {  
      endQuiz();  
    }  
  };  

  document.getElementById("prevBtn").onclick = () => {  
    if(currentQuestionIndex > 0){  
      currentQuestionIndex--;  
      showQuestion();  
    }  
  };  

  function startTimer(){  
    clearInterval(timer);  
    timer = setInterval(() => {  
      timeLeft--;  
      const minutes = Math.floor(timeLeft/60);  
      const seconds = timeLeft%60;  
      document.getElementById("timer").textContent =   
        `Time left: ${minutes.toString().padStart(2,"0")}:${seconds.toString().padStart(2,"0")}`;  
      if(timeLeft<=0){  
        clearInterval(timer);  
        endQuiz();  
      }  
    }, 1000);  
  }  

  function endQuiz(){  
    clearInterval(timer);  
    document.getElementById("quiz").classList.add("hidden");  
    document.getElementById("result").classList.remove("hidden");  

    score = 0;  
    questions.forEach((q, i) => {  
      if(userAnswers[i] !== null && q.answers[userAnswers[i]].correct){  
        score++;  
      }  
    });  

    const iq = Math.round((score / questions.length) * 150);  
    document.getElementById("finalScore").textContent = `You scored ${score}/${questions.length}. Estimated IQ: ${iq}`;  

    let suggestion = "";  
    if(iq < 70) suggestion = "Very Poor â€“ Needs Improvement.";  
    else if(iq < 90) suggestion = "Poor â€“ Keep practicing!";  
    else if(iq < 110) suggestion = "Average â€“ Good effort.";  
    else if(iq < 130) suggestion = "Good â€“ Above average intelligence.";  
    else suggestion = "Excellent â€“ Genius level!";  
    document.getElementById("suggestion").textContent = suggestion;  

    updateScoreboard(iq);  
    showReview();  
  }  

  function updateScoreboard(iq){  
    let scores = JSON.parse(localStorage.getItem("iqScores")||"[]");  
    scores.push(iq);  
    localStorage.setItem("iqScores", JSON.stringify(scores));  

    let scoreboardDiv = document.getElementById("scoreboard");  
    scoreboardDiv.innerHTML = "<h3>Scoreboard</h3>";  
    scores.forEach((s,i) => {  
      scoreboardDiv.innerHTML += `<p>Attempt ${i+1}: IQ ${s}</p>`;  
    });  
  }  

  function showReview(){  
    let reviewDiv = document.getElementById("reviewAnswers");  
    reviewDiv.innerHTML = "";  
    questions.forEach((q, i) => {  
      let userAns = userAnswers[i] !== null ? q.answers[userAnswers[i]].text : "Not answered";  
      let correctAns = q.answers.find(a => a.correct).text;  
      let div = document.createElement("div");  
      div.classList.add("review");  
      div.innerHTML = `  
        <p><b>Q${i+1}:</b> ${decodeHTML(q.question)}</p>  
        <p class="${userAns === correctAns ? "correct" : "wrong"}">  
          Your Answer: ${decodeHTML(userAns)}  
        </p>  
        <p class="correct">Correct Answer: ${decodeHTML(correctAns)}</p>  
      `;  
      reviewDiv.appendChild(div);  
    });  
  }  

  function restart(){  
    loadQuestions();  
  }  

  function decodeHTML(html) {  
    var txt = document.createElement("textarea");  
    txt.innerHTML = html;  
    return txt.value;  
  }  

  // Start by loading questions  
  loadQuestions();  
</script>  
</body>  
</html>